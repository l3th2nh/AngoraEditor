	<div class="easyui-layout" fit='true'>	<div data-options="region:'north'" style="height:64px;">		<div style="overflow:hidden">			<input id="animations" class="easyui-combobox" name="anim" >			<a id="addAnim" class="easyui-linkbutton" data-options="iconCls:'icon-ae-add'" style="border:none"></a>			<a id="removeAnim" class="easyui-linkbutton" data-options="iconCls:'icon-ae-remove'" style="border:none"></a>		</div>	</div>	<div data-options="region:'center'" >		<div id='container' style="position:relative;">			<img id="atlas" ></img>			<div id="animrect" style="position:absolute;left:0;top:0;border:1px solid red;height:16px;width:16px;"></div>		</div>	</div>	<div data-options="region:'east'" style="width:150px;">		<div id="animeproperty">property</div>	</div>	<div data-options="region:'south'" style="height:64px;">		<button id="btn_ok" style="float:left;margin-top:10px;">OK</button>		<button id="btn_cancel" style="float:right;margin-top:10px;">Cancel</button>	</div>	</div>	<script>	$(document).ready(function(){		var editor=edt;		var spritesheet=editor.res.get(editor.node.selected.image);		var path=editor.project.currentProject.path+"/"+spritesheet.path;		$('#atlas').attr('src',path);		var rows=parseInt(spritesheet.Yframe);		var cols=parseInt(spritesheet.Xframe);		var w=spritesheet.width/spritesheet.Xframe;		var h=spritesheet.height/spritesheet.Yframe;		var animations={};		var comboxValues=[];		var currentAnim=null;		var index=0;		$('#animations').combobox({data:comboxValues});		$('#animrect').css({width:w,height:h});		$('#animeproperty').propertygrid({			data : '',			onEndEdit : function (index, field, changes) {				var name = field['name'];				var value = field['value'];				switch (name) {				case 'width':					w=value;					$('#animrect').css('width',w+'px');					cols=$('#atlas').width()/w;					break;				case 'height':					h=value;					$('#animrect').css('height',h+'px');					rows=$('#atlas').height()/h;					break;				default:					break;				}			}		});		$('#atlas').mousemove(function(e){			var dposleft=$('#dd').dialog('dialog')[0].offsetLeft;			var dpostop=$('#dd').dialog('dialog')[0].offsetTop;			var cpos=$('#atlas').position();			var left=Math.floor((e.pageX-dposleft-w/2)/w)*w;			var top=Math.floor((e.pageY-dpostop-64-h/2)/h)*h;			$('#animrect').css({left:left,top:top});			index=top/h*cols+left/w;		});		$('#addAnim').click(function(){			comboxValues=[];			var name=prompt('Enter animation name','anim');			currentAnim=name;			animations[currentAnim]={};			animations[currentAnim].sequence=[];			comboxValues.push(name);			$('#animations').combobox('setValues', comboxValues);			$('#animeproperty').propertygrid('loadData',[				{"name":"width","value":w,"editor":"none"},				{"name":"height","value":h,"editor":"none"},				{"name":"sequence","value":"","editor":"text"}			]);		});		$('#animrect').click(function(){			if(currentAnim!=null){				animations[currentAnim].sequence.push(index);				$('#animeproperty').propertygrid('updateRow',{					index: 2,					row: {						value:animations[currentAnim].sequence.toString()					}				});			}		});		$("#btn_ok").click(function(){			//editor.res.anim=animations;			editor.attr.setAttr(editor.node.selected,'animations',animations);			$('#dd').dialog('close');		});		$("#btn_cancel").click(function(){			$('#dd').dialog('close');		});	});	</script>